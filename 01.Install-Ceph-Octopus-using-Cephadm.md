# Install Ceph Octopus using cephadm

## 1. Install NTP
```sh
yum install chrony -y
timedatectl set-timezone Asia/Ho_Chi_Minh

sed -i 's/server 0.centos.pool.ntp.org iburst/ \
server 0.asia.pool.ntp.org iburst \
server 1.asia.pool.ntp.org iburst/g' /etc/chrony.conf
sed -i 's/server 1.centos.pool.ntp.org iburst/#server 1.centos.pool.ntp.org iburst/g' /etc/chrony.conf
sed -i 's/server 2.centos.pool.ntp.org iburst/#server 2.centos.pool.ntp.org iburst/g' /etc/chrony.conf
sed -i 's/server 3.centos.pool.ntp.org iburst/#server 3.centos.pool.ntp.org iburst/g' /etc/chrony.conf
```
Start NTP
```sh
systemctl enable chronyd.service
systemctl start chronyd.service
```
## 2. Install docker
```sh
yum install docker -y
```
Start and enable docker
```sh
systemctl start docker
systemctl enable docker
```
## 3. Install Cephadm
Install cephadm
```sh
yum install -y cephadm
```
### 3.1 BOOTSTRAP A NEW CLUSTER
```sh
mkdir -p /etc/ceph
cephadm bootstrap --mon-ip 192.168.1.111
```
### 3.2 ENABLE CEPH CLI
Cephadm không yêu cầy bất kỳ `Ceph packages` nào để cài đặt trên host. Tuy nhiên để dễ dàng sử dụng ceph command. Có nhiều cách để thực hiện điều này:

- `cephadm` chạy 1 bash shell trong 1 container với tất cả các Ceph packages được cài đặt. Mặc định nếu file `configuration` và `keyring` được tìm thấy trong `/etc/ceph` trên host, they are passed into the container environment so that the shell is fully functional:
```sh
cephadm shell
```
- Có thể cài đặt `ceph-common` package chưa tất cả `ceph commands` bao gồm `ceph`, `rbd`, `mount.ceph` (cho mounting CephFS file systems)...:
```sh
cephadm add-repo --release octopus
cephadm install ceph-common
```
Confirm that the ceph command is accessible with:
```sh
ceph -v
```
Confirm that the ceph command can connect to the cluster and also its status with:
```sh
ceph status
```
The cephadm shell command launches a bash shell in a container with all of the Ceph packages installed. By default, if configuration and keyring files are found in /etc/ceph on the host, they are passed into the container environment so that the shell is fully functional:

## Tài liệu tham khảo
- https://docs.ceph.com/docs/master/cephadm/install/
